/* Задача 1: Вывести минимальную площадь стран */
SELECT MIN(Площадь) AS Мин_площадь FROM Страны
/* Задача 2: Вывести наибольшую по населению страну в Северной и Южной Америке */
SELECT TOP 1 Название, Население FROM Страны WHERE Континент IN ('Северная Америка', 'Южная Америка') ORDER BY Население DESC
/* Задача 3: Вывести среднее население стран. Результат округлить до одного знака */
SELECT ROUND(AVG(CAST(Население AS FLOAT)), 1) AS Среднее_население FROM Страны
/* Задача 4: Вывести количество стран, у которых название заканчивается на «ан», кроме стран, у которых название заканчивается на «стан» */
SELECT COUNT(*) AS Количество FROM Страны WHERE Название LIKE '%ан' AND Название NOT LIKE '%стан'
/* Задача 5: Вывести количество континентов, где есть страны, название которых начинается с буквы «Р» */
SELECT COUNT(DISTINCT Континент) AS Количество_континентов FROM Страны WHERE LEFT(Название, 1) = 'Р'
/* Задача 6: Сколько раз страна с наибольшей площадью больше, чем страна с наименьшей площадью */
SELECT CAST(MAX(Площадь) AS FLOAT) / MIN(Площадь) AS Разница_площадей FROM Страны
/* Задача 7: Вывести количество стран с населением больше, чем 100 млн. чел. на каждом континенте. Результат отсортировать по количеству стран по возрастанию */
SELECT Континент, COUNT(*) AS Количество_стран FROM Страны WHERE Население > 100000000 GROUP BY Континент ORDER BY Количество_стран ASC
/* Задача 8: Вывести количество стран по количеству букв в названии. Результат отсортировать по убыванию */
SELECT LEN(Название) AS Длина_названия, COUNT(*) AS Количество_стран FROM Страны GROUP BY LEN(Название) ORDER BY Длина_названия DESC
/* Задача 9: Ожидается, что через 20 лет население мира вырастет на 10%. Вывести список континентов с прогнозируемым населением */
SELECT Континент, FLOOR(SUM(Население) * 1.1) AS Прогноз_населения FROM Страны GROUP BY Континент
/* Задача 10: Вывести список континентов, где разница по площади между наибольшими и наименьшими странами не более в 10000 раз */
SELECT Континент FROM Страны GROUP BY Континент HAVING MAX(Площадь) <= 10000 * MIN(Площадь)
/* Задача 11: Вывести среднюю длину названий Африканских стран */
SELECT AVG(CAST(LEN(Название) AS FLOAT)) AS Средняя_длина FROM Страны WHERE Континент = 'Африка'
/* Задача 12: Вывести список континентов, у которых средняя плотность среди стран с населением более 1 млн. чел. больше, чем 30 чел. на кв. км */
SELECT Континент, AVG(CAST(Население AS FLOAT) / Площадь) AS Плотность FROM Страны WHERE Население > 1000000 GROUP BY Континент HAVING AVG(CAST(Население AS FLOAT) / Площадь) > 30