/* Задача 1: Вывести из таблиц «Кафедра», «Специальность» и «Студент» данные о студентах, которые обучаются на данном факультете (например, «Ит») */
SELECT С.Фамилия, П.Направление, К.Название AS Кафедра FROM Студент С INNER JOIN Специальность П ON С.Номер = П.Номер INNER JOIN Кафедра К ON П.Шифр = К.Шифр WHERE К.Факультет = 'Ит'
/* Задача 2: Вывести из таблиц «Кафедра», «Специальность» и «Сотрудник» данные о выпускающих кафедрах (факультет, шифр, название, фамилию заведующего) */
SELECT К.Факультет, К.Шифр, К.Название AS Кафедра, С.ФИО AS Заведующий FROM Кафедра К INNER JOIN Специальность П ON К.Шифр = П.Шифр INNER JOIN Сотрудник С ON С.Таб_номер IN (SELECT Таб_номер FROM Зав_кафедрой) AND С.Должность = 'зав. кафедрой'
/* Задача 3: Вывести для каждого сотрудника номер и фамилию его непосредственного руководителя, для заведующих кафедрами поле руководителя оставить пустым */
SELECT С.ФИО, С.Должность, CASE WHEN С.Должность = 'зав. кафедрой' THEN NULL ELSE П.Таб_номер END AS Номер_руководителя, CASE WHEN С.Должность = 'зав. кафедрой' THEN NULL ELSE П.ФИО END AS Руководитель FROM Сотрудник С LEFT JOIN Сотрудник П ON С.Начальник = П.Таб_номер
/* Задача 4: Вывести список студентов, сдавших минимум два экзамена */
SELECT С.Фамилия FROM Студент С INNER JOIN Экзамен Э ON С.Рег_номер = Э.Рег_номер GROUP BY С.Фамилия HAVING COUNT(Э.Оценка) >= 2
/* Задача 5: Вывести список инженеров с зарплатой, меньшей 20000 руб. */
SELECT С.ФИО, С.Зарплата FROM Сотрудник С INNER JOIN Инженер И ON С.Таб_номер = И.Таб_номер WHERE С.Зарплата < 20000
/* Задача 6: Вывести список студентов, сдавших экзамены в заданной аудитории (например, 'т505') */
SELECT DISTINCT С.Фамилия FROM Студент С INNER JOIN Экзамен Э ON С.Рег_номер = Э.Рег_номер WHERE Э.Аудитория = 'т505'
/* Задача 7: Вывести учетные номера и фамилии студентов, количество сданных экзаменов и средний балл для студентов со средним баллом не меньше 4 */
SELECT С.Фамилия, С.Рег_номер, COUNT(Э.Оценка) AS [Количество экзаменов], AVG(CAST(Э.Оценка AS FLOAT)) AS [Средний балл] FROM Студент С INNER JOIN Экзамен Э ON С.Рег_номер = Э.Рег_номер GROUP BY С.Фамилия, С.Рег_номер HAVING AVG(CAST(Э.Оценка AS FLOAT)) >= 4
/* Задача 8: Вывести список заведующих кафедрами и их зарплаты, и степень */
SELECT С.ФИО, С.Зарплата, П.Степень FROM Сотрудник С INNER JOIN Зав_кафедрой З ON С.Таб_номер = З.Таб_номер INNER JOIN Преподаватель П ON С.Таб_номер = П.Таб_номер
/* Задача 9: Вывести список профессоров */
SELECT С.ФИО, П.Звание FROM Сотрудник С INNER JOIN Преподаватель П ON С.Таб_номер = П.Таб_номер WHERE П.Звание = 'профессор'
/* Задача 10: Вывести название дисциплины, фамилию, должность и степень преподавателя, дату и место проведения экзаменов в заданном интервале дат (например, с 05.06.2015 по 10.06.2015) */
SELECT DISTINCT Д.Название AS Дисциплина, С.ФИО, С.Должность, П.Степень, Э.Дата, Э.Аудитория FROM Экзамен Э INNER JOIN Дисциплина Д ON Э.Код = Д.Код INNER JOIN Сотрудник С ON Э.Таб_номер = С.Таб_номер INNER JOIN Преподаватель П ON Э.Таб_номер = П.Таб_номер WHERE Э.Дата BETWEEN '2015-06-05' AND '2015-06-10' ORDER BY Э.Дата
/* Задача 11: Вывести фамилию преподавателей, принявших более трех экзаменов */
SELECT С.ФИО, COUNT(Э.Дата) AS [Количество экзаменов] FROM Экзамен Э INNER JOIN Сотрудник С ON Э.Таб_номер = С.Таб_номер GROUP BY С.ФИО HAVING COUNT(Э.Дата) > 3
/* Задача 12: Вывести список студентов, не сдавших ни одного экзамена в указанной дате (например, '2015-06-05') */
SELECT С.Фамилия FROM Студент С LEFT OUTER JOIN Экзамен Э ON С.Рег_номер = Э.Рег_номер AND Э.Дата = '2015-06-05' WHERE Э.Рег_номер IS NULL
