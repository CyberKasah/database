/* Задание 1: Создать триггер на изменение записи в таблице «Ученики», выводящий «Запись изменена» */
CREATE TRIGGER Задание1 ON Ученики FOR UPDATE AS BEGIN PRINT 'Запись изменена' END
/* Задание 2: Создать триггер на добавление и удаление записи из таблицы «Ученики», выводящий «Количество строк изменено» */
CREATE TRIGGER Задание2 ON Ученики FOR INSERT, DELETE AS BEGIN PRINT 'Количество строк изменено' END
/* Задание 3: Создать триггер на добавление, изменение и удаление данных в таблице «Ученики», выводящий текущего пользователя и время изменения */
CREATE TRIGGER Задание3 ON Ученики FOR INSERT, UPDATE, DELETE AS BEGIN PRINT System_User + ' изменил таблицу. Время: ' + CONVERT(VARCHAR, GETDATE(), 120) END
/* Задание 4: Создать триггер на изменение записи в таблице «Ученики», выводящий «Нельзя редактировать данные» */
CREATE TRIGGER Задание4 ON Ученики INSTEAD OF UPDATE AS BEGIN PRINT 'Нельзя редактировать данные' END
/* Задание 5: Создать таблицу «Ученики_Колесник» и триггер для фиксации удалённых учеников с однофамильцами */
CREATE TABLE Ученики_Колесник (Фамилия VARCHAR(50) NULL, Удалено DATETIME NOT NULL) CREATE TRIGGER Задание5 ON Ученики FOR DELETE AS BEGIN INSERT Ученики_Колесник SELECT D.Фамилия, GETDATE() AS Удалено FROM DELETED D WHERE EXISTS (SELECT 1 FROM Ученики U WHERE U.Фамилия = D.Фамилия) END
/* Задание 6: Приостановить и запустить триггер Задание5 */
DISABLE TRIGGER Задание5 ON Ученики ENABLE TRIGGER Задание5 ON Ученики
/* Задание 7: Удалить все созданные триггеры */
/*DROP TRIGGER Задание1, Задание2, Задание3, Задание4, Задание5*/